{"layout":"tutorial_hands_on","title":"Analysis of plant scRNA-Seq Data with Scanpy","subtopic":"end-to-end","priority":3,"redirect_from":["/topics/transcriptomics/tutorials/scrna-plant/tutorial","/short/single-cell/scrna-plant","/short/T00250"],"zenodo_link":"https://zenodo.org/record/4597857","tags":["plants","paper-replication"],"questions":["Can we reclaim cell markers using a different analysis method?","Are highly variable genes paramount to the analysis?"],"objectives":["Perform filtering, dimensionality reduction, and clustering","Generate a DotPlot emulating the original paper using a different analysis tool","Determine robust clusters across scRNA-seq pipelines"],"requirements":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-scanpy-pbmc3k"]}],"time_estimation":"2H","key_points":["Filtering parameters are dependent on the dataset, and should be explored using scatter or violin plots","A DotPlot is a fantastic way to validate clusters across different analyses"],"contributors":[{"name":"Mehmet Tekman","email":"mtekman89@gmail.com","joined":"2018-11","elixir_node":"de","affiliations":["uni-freiburg"],"former_affiliations":["elixir-europe"],"id":"mtekman","url":"https://training.galaxyproject.org/training-material/api/contributors/mtekman.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mtekman/"},{"name":"Beatriz Serrano-Solano","email":"beatrizserrano.galaxy@gmail.com","twitter":"BSerranoSolano","linkedin":"beatriz-serrano","matrix":"beatrizserrano:matrix.org","orcid":"0000-0002-5862-6132","joined":"2020-07","id":"beatrizserrano","url":"https://training.galaxyproject.org/training-material/api/contributors/beatrizserrano.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/beatrizserrano/"},{"name":"Cristóbal Gallardo","joined":"2020-11","elixir_node":"de","orcid":"0000-0002-5752-2155","former_affiliations":["uni-freiburg","elixir-europe"],"id":"gallardoalba","url":"https://training.galaxyproject.org/training-material/api/contributors/gallardoalba.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/gallardoalba/"},{"name":"Pavankumar Videm","orcid":"0000-0002-5192-126X","joined":"2017-09","affiliations":["uni-freiburg","elixir-europe"],"id":"pavanvidem","url":"https://training.galaxyproject.org/training-material/api/contributors/pavanvidem.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pavanvidem/"}],"gitter":"Galaxy-Training-Network/galaxy-single-cell","recordings":[{"captioners":["mtekman"],"date":"2021-02-15","galaxy_version":"21.01","length":"55M","youtube_id":"yKlJ5ESri7o","speakers":["mtekman"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00250","url":"/topics/single-cell/tutorials/scrna-plant/tutorial.html","topic_name":"single-cell","tutorial_name":"scrna-plant","dir":"topics/single-cell/tutorials/scrna-plant","symlink":null,"id":"single-cell/scrna-plant","hands_on":true,"slides":false,"mod_date":"2024-06-14 09:56:50 +0000","pub_date":"2021-04-08 10:59:53 +0000","version":5,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-plant/workflows/main_workflow.ga","url_html":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-plant/workflows/main_workflow.html","path":"topics/single-cell/tutorials/scrna-plant/workflows/main_workflow.ga","wfid":"single-cell-scrna-plant","wfname":"main-workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-plant/versions/main-workflow","license":null,"parent_id":"single-cell/scrna-plant","topic_id":"single-cell","tutorial_id":"scrna-plant","creators":[],"name":"scRNA Plant Analysis","title":"scRNA Plant Analysis","version":1,"description":"Downstream Single-cell RNA Plant analysis with ScanPy","tags":["transcriptomics","single-cell"],"features":{"report":null,"subworkflows":false,"comments":false,"parameters":true},"workflowhub_id":"1266","history":[{"hash":"327fd2b842f45de3dc2a30067714352675ad69ae","unix":"1668273265","message":"Making a single cell topics","short_hash":"327fd2b84","num":1}],"test_results":null,"modified":"2024-07-17 09:42:54 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Parameter\\nLeiden Resolution\"];\n  style 0 fill:#ded,stroke:#393,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nSHR CSV.gz\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nWT CSV.gz\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Parameter\\nMin Genes\"];\n  style 3 fill:#ded,stroke:#393,stroke-width:4px;\n  4[\"ℹ️ Input Parameter\\nMin Cells\"];\n  style 4 fill:#ded,stroke:#393,stroke-width:4px;\n  5[\"ℹ️ Input Parameter\\nMax Features\"];\n  style 5 fill:#ded,stroke:#393,stroke-width:4px;\n  6[\"ℹ️ Input Parameter\\nMax Lib Size\"];\n  style 6 fill:#ded,stroke:#393,stroke-width:4px;\n  7[\"Import Anndata and loom\"];\n  1 -->|output| 7;\n  8[\"Import Anndata and loom\"];\n  2 -->|output| 8;\n  9[\"Manipulate AnnData\"];\n  7 -->|anndata| 9;\n  8 -->|anndata| 9;\n  10[\"Rename Batches\"];\n  9 -->|anndata| 10;\n  680180f6-edfc-4f66-b265-7a63aaa22b39[\"Output\\nscRNA Concatenated Datasets\"];\n  10 --> 680180f6-edfc-4f66-b265-7a63aaa22b39;\n  style 680180f6-edfc-4f66-b265-7a63aaa22b39 stroke:#2c3143,stroke-width:4px;\n  11[\"QC metrics\"];\n  10 -->|anndata| 11;\n  12[\"Filter genes\"];\n  11 -->|anndata_out| 12;\n  3 -->|output| 12;\n  13[\"Plot Violin\"];\n  11 -->|anndata_out| 13;\n  14[\"Filter Cells\"];\n  12 -->|anndata_out| 14;\n  4 -->|output| 14;\n  15[\"Filter Max Features\"];\n  14 -->|anndata_out| 15;\n  5 -->|output| 15;\n  16[\"Filter Max Library Size\"];\n  15 -->|anndata| 16;\n  6 -->|output| 16;\n  17[\"Save RAW\"];\n  16 -->|anndata| 17;\n  18[\"Norm to 1e4\"];\n  17 -->|anndata| 18;\n  19[\"Log1p\"];\n  18 -->|anndata_out| 19;\n  20[\"Regress total counts\"];\n  19 -->|anndata_out| 20;\n  21[\"Scale\"];\n  20 -->|anndata_out| 21;\n  22[\"PCA\"];\n  21 -->|anndata_out| 22;\n  23[\"Neighborhod\"];\n  22 -->|anndata_out| 23;\n  24[\"UMAP\"];\n  23 -->|anndata_out| 24;\n  25[\"Leiden\"];\n  24 -->|anndata_out| 25;\n  0 -->|output| 25;\n  48cf0465-84ba-461a-bdb9-61625626de42[\"Output\\nscRNA with clusters Dataset\"];\n  25 --> 48cf0465-84ba-461a-bdb9-61625626de42;\n  style 48cf0465-84ba-461a-bdb9-61625626de42 stroke:#2c3143,stroke-width:4px;\n  26[\"Plot PCA batch\"];\n  24 -->|anndata_out| 26;\n  27[\"Plot UMAP batch\"];\n  24 -->|anndata_out| 27;\n  28[\"Plot UMAP leiden, batch\"];\n  25 -->|anndata_out| 28;\n  29[\"Rename Clusters\"];\n  25 -->|anndata_out| 29;\n  30[\"Complex DotPlot\"];\n  25 -->|anndata_out| 30;\n  31[\"Complex DotPlot with new labels\"];\n  29 -->|anndata| 31;\n  32[\"Plot UMAP with new labels\"];\n  29 -->|anndata| 32;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightgreen,label=\"ℹ️ Input Parameter\\nLeiden Resolution\"]\n  1[color=lightblue,label=\"ℹ️ Input Dataset\\nSHR CSV.gz\"]\n  2[color=lightblue,label=\"ℹ️ Input Dataset\\nWT CSV.gz\"]\n  3[color=lightgreen,label=\"ℹ️ Input Parameter\\nMin Genes\"]\n  4[color=lightgreen,label=\"ℹ️ Input Parameter\\nMin Cells\"]\n  5[color=lightgreen,label=\"ℹ️ Input Parameter\\nMax Features\"]\n  6[color=lightgreen,label=\"ℹ️ Input Parameter\\nMax Lib Size\"]\n  7[label=\"Import Anndata and loom\"]\n  1 -> 7 [label=\"output\"]\n  8[label=\"Import Anndata and loom\"]\n  2 -> 8 [label=\"output\"]\n  9[label=\"Manipulate AnnData\"]\n  7 -> 9 [label=\"anndata\"]\n  8 -> 9 [label=\"anndata\"]\n  10[label=\"Rename Batches\"]\n  9 -> 10 [label=\"anndata\"]\n  k680180f6edfc4f66b2657a63aaa22b39[color=lightseagreen,label=\"Output\\nscRNA Concatenated Datasets\"]\n  10 -> k680180f6edfc4f66b2657a63aaa22b39\n  11[label=\"QC metrics\"]\n  10 -> 11 [label=\"anndata\"]\n  12[label=\"Filter genes\"]\n  11 -> 12 [label=\"anndata_out\"]\n  3 -> 12 [label=\"output\"]\n  13[label=\"Plot Violin\"]\n  11 -> 13 [label=\"anndata_out\"]\n  14[label=\"Filter Cells\"]\n  12 -> 14 [label=\"anndata_out\"]\n  4 -> 14 [label=\"output\"]\n  15[label=\"Filter Max Features\"]\n  14 -> 15 [label=\"anndata_out\"]\n  5 -> 15 [label=\"output\"]\n  16[label=\"Filter Max Library Size\"]\n  15 -> 16 [label=\"anndata\"]\n  6 -> 16 [label=\"output\"]\n  17[label=\"Save RAW\"]\n  16 -> 17 [label=\"anndata\"]\n  18[label=\"Norm to 1e4\"]\n  17 -> 18 [label=\"anndata\"]\n  19[label=\"Log1p\"]\n  18 -> 19 [label=\"anndata_out\"]\n  20[label=\"Regress total counts\"]\n  19 -> 20 [label=\"anndata_out\"]\n  21[label=\"Scale\"]\n  20 -> 21 [label=\"anndata_out\"]\n  22[label=\"PCA\"]\n  21 -> 22 [label=\"anndata_out\"]\n  23[label=\"Neighborhod\"]\n  22 -> 23 [label=\"anndata_out\"]\n  24[label=\"UMAP\"]\n  23 -> 24 [label=\"anndata_out\"]\n  25[label=\"Leiden\"]\n  24 -> 25 [label=\"anndata_out\"]\n  0 -> 25 [label=\"output\"]\n  k48cf046584ba461abdb961625626de42[color=lightseagreen,label=\"Output\\nscRNA with clusters Dataset\"]\n  25 -> k48cf046584ba461abdb961625626de42\n  26[label=\"Plot PCA batch\"]\n  24 -> 26 [label=\"anndata_out\"]\n  27[label=\"Plot UMAP batch\"]\n  24 -> 27 [label=\"anndata_out\"]\n  28[label=\"Plot UMAP leiden, batch\"]\n  25 -> 28 [label=\"anndata_out\"]\n  29[label=\"Rename Clusters\"]\n  25 -> 29 [label=\"anndata_out\"]\n  30[label=\"Complex DotPlot\"]\n  25 -> 30 [label=\"anndata_out\"]\n  31[label=\"Complex DotPlot with new labels\"]\n  29 -> 31 [label=\"anndata\"]\n  32[label=\"Plot UMAP with new labels\"]\n  29 -> 32 [label=\"anndata\"]\n}","workflow_tools":["toolshed.g2.bx.psu.edu/repos/iuc/anndata_import/anndata_import/0.7.5+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_inspect/scanpy_inspect/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_filter/scanpy_filter/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_normalize/scanpy_normalize/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_remove_confounders/scanpy_remove_confounders/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_cluster_reduce_dimension/scanpy_cluster_reduce_dimension/1.7.1+galaxy0"]}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-plant/tutorial.json","tools":["toolshed.g2.bx.psu.edu/repos/iuc/anndata_import/anndata_import/0.7.5+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_cluster_reduce_dimension/scanpy_cluster_reduce_dimension/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_filter/scanpy_filter/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_inspect/scanpy_inspect/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_normalize/scanpy_normalize/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_remove_confounders/scanpy_remove_confounders/1.7.1+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false},{"url":"https://usegalaxy.no/","name":"UseGalaxy.no","usegalaxy":false}]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"anndata_import","owner":"iuc","revisions":"55e35e9203cf","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_manipulate","owner":"iuc","revisions":"9bd945a03d7b","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_cluster_reduce_dimension","owner":"iuc","revisions":"aaa5da8e73a9","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_filter","owner":"iuc","revisions":"b409c2486353","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_inspect","owner":"iuc","revisions":"c5d3684f7c4c","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_normalize","owner":"iuc","revisions":"ab55fe8030b6","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_plot","owner":"iuc","revisions":"6adf98e782f3","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_remove_confounders","owner":"iuc","revisions":"bf2017df9837","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: anndata_import\n  owner: iuc\n  revisions: 55e35e9203cf\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_manipulate\n  owner: iuc\n  revisions: 9bd945a03d7b\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_cluster_reduce_dimension\n  owner: iuc\n  revisions: aaa5da8e73a9\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_filter\n  owner: iuc\n  revisions: b409c2486353\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_inspect\n  owner: iuc\n  revisions: c5d3684f7c4c\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_normalize\n  owner: iuc\n  revisions: ab55fe8030b6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_plot\n  owner: iuc\n  revisions: 6adf98e782f3\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_remove_confounders\n  owner: iuc\n  revisions: bf2017df9837\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}