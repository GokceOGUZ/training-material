{"layout":"tutorial_hands_on","title":"Single-cell ATAC-seq standard processing with SnapATAC2","subtopic":"scmultiomics","priority":2,"redirect_from":["/topics/transcriptomics/tutorials/scatac-standard-processing-snapatac2/tutorial","/short/single-cell/scatac-standard-processing-snapatac2","/short/T00445"],"level":"Intermediate","zenodo_link":"https://zenodo.org/records/12707159","questions":["What does ATAC-seq data tell us about the cell?","Which steps are necessary to cluster the cells of single-cell ATAC-seq data?","Why is dimension reduction important for the analysis of single-cell data?"],"objectives":["Learn how single-cell ATAC-seq data is processed","Create a count-matrix from a 10X fragment file","Perform filtering, dimension reduction and clustering on AnnData matrices","Generate and filter a cell-by-gene matrix","Identify marker genes for the clusters and annotate the cell types"],"time_estimation":"4H","key_points":["Single-cell ATAC-seq can identify open chromatin sites","Dimension reduction is required to simplify the data while preserving important information about the relationships of cells to each other.","Clusters of similar cells can be annotated to their respective cell-types"],"requirements":[{"type":"internal","topic_name":"single-cell","tutorials":["scatac-preprocessing-tenx"]}],"tags":["10x","epigenetics","single-cell"],"abbreviations":{"scATAC-seq":"Single-cell Assay for Transposase-Accessible Chromatin using sequencing","PBMCs":"peripheral blood mononuclear cells","QC":"quality control","TSSe":"transcription start site enrichment","TSS":"transcription start sites","UMAP":"Uniform Manifold Approximation and Projection"},"contributions":{"authorship":["timonschlegel"],"editing":["pavanvidem","bgruening"],"testing":["pavanvidem"]},"gitter":"Galaxy-Training-Network/galaxy-single-cell","js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00445","url":"/topics/single-cell/tutorials/scatac-standard-processing-snapatac2/tutorial.html","topic_name":"single-cell","tutorial_name":"scatac-standard-processing-snapatac2","dir":"topics/single-cell/tutorials/scatac-standard-processing-snapatac2","symlink":null,"id":"single-cell/scatac-standard-processing-snapatac2","hands_on":true,"slides":false,"mod_date":"2024-07-11 14:34:09 +0000","pub_date":"2024-07-11 14:34:09 +0000","version":1,"workflows":[{"workflow":"Standard-processing-of-10X-single-cell-ATAC-seq-data-with-SnapATAC2.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scatac-standard-processing-snapatac2/workflows/Standard-processing-of-10X-single-cell-ATAC-seq-data-with-SnapATAC2.ga","url_html":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scatac-standard-processing-snapatac2/workflows/Standard-processing-of-10X-single-cell-ATAC-seq-data-with-SnapATAC2.html","path":"topics/single-cell/tutorials/scatac-standard-processing-snapatac2/workflows/Standard-processing-of-10X-single-cell-ATAC-seq-data-with-SnapATAC2.ga","wfid":"single-cell-scatac-standard-processing-snapatac2","wfname":"standard-processing-of-10x-single-cell-atac-seq-data-with-snapatac2","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scatac-standard-processing-snapatac2/versions/standard-processing-of-10x-single-cell-atac-seq-data-with-snapatac2","license":"CC-BY-4.0","parent_id":"single-cell/scatac-standard-processing-snapatac2","topic_id":"single-cell","tutorial_id":"scatac-standard-processing-snapatac2","creators":[{"class":"Person","identifier":"0009-0001-3228-105X","name":"Timon Schlegel"}],"name":"Workflow - Standard processing of 10X single cell ATAC-seq data with SnapATAC2","title":"Workflow - Standard processing of 10X single cell ATAC-seq data with SnapATAC2","version":1,"description":"Workflow of Tutorial \"Single-cell ATAC-seq standard processing with SnapATAC2\".\nThis workflow takes a fragment file as input and performs the standard steps of scATAC-seq analysis: filtering, dimension reduction, embedding and visualization of marker genes with SnapATAC2.\nIn an alternative step, the fragment file can also be generated from a BAM file. ","tags":["scATAC-seq","epigenetics"],"features":{"report":{"markdown":"\n# Workflow Execution Report\n\n## Workflow Inputs\n```galaxy\ninvocation_inputs()\n```\n\n## Workflow Outputs\n```galaxy\ninvocation_outputs()\n```\n\n## Workflow\n```galaxy\nworkflow_display()\n```\n"},"subworkflows":false,"comments":true,"parameters":true},"workflowhub_id":"1343","history":[{"hash":"9740cbbaddce4bd770c90ec91e8990d0cddf3bc8","unix":"1720704591","message":"Update workflow and add tests","short_hash":"9740cbbad","num":1}],"test_results":null,"modified":"2024-07-16 10:51:04 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nFragment_file\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nchromosome_sizes.tabular\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\ngene_annotation\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nBam-file\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"ℹ️ Input Parameter\\nKeys for annotations of obs/cells or vars/genes\"];\n  style 4 fill:#ded,stroke:#393,stroke-width:4px;\n  5[\"ℹ️ Input Dataset\\nReplace_file\"];\n  style 5 stroke:#2c3143,stroke-width:4px;\n  6[\"pp.import_data\"];\n  1 -->|output| 6;\n  0 -->|output| 6;\n  7[\"pp.make_fragment_file\"];\n  3 -->|output| 7;\n  8[\"pl.frag_size_distr\"];\n  6 -->|anndata_out| 8;\n  265d6020-44e2-408c-9eb6-02cbc9ac23a7[\"Output\\nplot frag_size\"];\n  8 --> 265d6020-44e2-408c-9eb6-02cbc9ac23a7;\n  style 265d6020-44e2-408c-9eb6-02cbc9ac23a7 stroke:#2c3143,stroke-width:4px;\n  9[\"pl.frag_size_distr_log\"];\n  6 -->|anndata_out| 9;\n  a37cd3c3-e07e-4bea-899f-ee44cee8370b[\"Output\\nplot log frag_size\"];\n  9 --> a37cd3c3-e07e-4bea-899f-ee44cee8370b;\n  style a37cd3c3-e07e-4bea-899f-ee44cee8370b stroke:#2c3143,stroke-width:4px;\n  10[\"metrics.tsse\"];\n  6 -->|anndata_out| 10;\n  2 -->|output| 10;\n  233284e5-c184-4330-a1d3-2d03951c4ce7[\"Output\\nanndata tsse\"];\n  10 --> 233284e5-c184-4330-a1d3-2d03951c4ce7;\n  style 233284e5-c184-4330-a1d3-2d03951c4ce7 stroke:#2c3143,stroke-width:4px;\n  11[\"pp.import_data-sorted_by_barcodes\"];\n  1 -->|output| 11;\n  7 -->|fragments_out| 11;\n  50ef9fe7-bb08-4957-bc45-079ed78f9ee8[\"Output\\nanndata\"];\n  11 --> 50ef9fe7-bb08-4957-bc45-079ed78f9ee8;\n  style 50ef9fe7-bb08-4957-bc45-079ed78f9ee8 stroke:#2c3143,stroke-width:4px;\n  12[\"pl.tsse\"];\n  10 -->|anndata_out| 12;\n  9a5c0f9c-0423-4822-871e-ba8317f2fa7b[\"Output\\nplot tsse\"];\n  12 --> 9a5c0f9c-0423-4822-871e-ba8317f2fa7b;\n  style 9a5c0f9c-0423-4822-871e-ba8317f2fa7b stroke:#2c3143,stroke-width:4px;\n  13[\"pp.filter_cells\"];\n  10 -->|anndata_out| 13;\n  b58dc4ad-6bf0-4f31-99f4-4f8deb13427c[\"Output\\nanndata filter cells\"];\n  13 --> b58dc4ad-6bf0-4f31-99f4-4f8deb13427c;\n  style b58dc4ad-6bf0-4f31-99f4-4f8deb13427c stroke:#2c3143,stroke-width:4px;\n  14[\"pp.add_tile_matrix\"];\n  13 -->|anndata_out| 14;\n  d4b64fc4-fd35-4781-b799-0d07fe8fe438[\"Output\\nanndata tile matrix\"];\n  14 --> d4b64fc4-fd35-4781-b799-0d07fe8fe438;\n  style d4b64fc4-fd35-4781-b799-0d07fe8fe438 stroke:#2c3143,stroke-width:4px;\n  15[\"pp.select_features\"];\n  14 -->|anndata_out| 15;\n  f531f6bd-3fc6-48b9-bb33-66de7928e670[\"Output\\nanndata select features\"];\n  15 --> f531f6bd-3fc6-48b9-bb33-66de7928e670;\n  style f531f6bd-3fc6-48b9-bb33-66de7928e670 stroke:#2c3143,stroke-width:4px;\n  16[\"pp.scrublet\"];\n  15 -->|anndata_out| 16;\n  5b17aa3a-3694-440f-9022-cf9761feb760[\"Output\\nanndata scrublet\"];\n  16 --> 5b17aa3a-3694-440f-9022-cf9761feb760;\n  style 5b17aa3a-3694-440f-9022-cf9761feb760 stroke:#2c3143,stroke-width:4px;\n  17[\"pp.filter_doublets\"];\n  16 -->|anndata_out| 17;\n  3838cf9d-a018-4aa7-8852-893b2f60ec2a[\"Output\\nanndata filter doublets\"];\n  17 --> 3838cf9d-a018-4aa7-8852-893b2f60ec2a;\n  style 3838cf9d-a018-4aa7-8852-893b2f60ec2a stroke:#2c3143,stroke-width:4px;\n  18[\"tl.spectral\"];\n  17 -->|anndata_out| 18;\n  77883516-8ac4-40b5-8b75-5750639d9fc4[\"Output\\nanndata spectral\"];\n  18 --> 77883516-8ac4-40b5-8b75-5750639d9fc4;\n  style 77883516-8ac4-40b5-8b75-5750639d9fc4 stroke:#2c3143,stroke-width:4px;\n  19[\"tl.umap\"];\n  18 -->|anndata_out| 19;\n  062a5471-7b7a-4d9b-bf6c-fe9bbbc5d2ad[\"Output\\nanndata umap\"];\n  19 --> 062a5471-7b7a-4d9b-bf6c-fe9bbbc5d2ad;\n  style 062a5471-7b7a-4d9b-bf6c-fe9bbbc5d2ad stroke:#2c3143,stroke-width:4px;\n  20[\"pp.knn\"];\n  19 -->|anndata_out| 20;\n  b7ebe580-9938-48e5-8718-4df197126615[\"Output\\nanndata knn\"];\n  20 --> b7ebe580-9938-48e5-8718-4df197126615;\n  style b7ebe580-9938-48e5-8718-4df197126615 stroke:#2c3143,stroke-width:4px;\n  21[\"tl.leiden\"];\n  20 -->|anndata_out| 21;\n  9970eb96-013b-4d97-bbbf-2d1f4663b73c[\"Output\\nanndata_leiden_clustering\"];\n  21 --> 9970eb96-013b-4d97-bbbf-2d1f4663b73c;\n  style 9970eb96-013b-4d97-bbbf-2d1f4663b73c stroke:#2c3143,stroke-width:4px;\n  22[\"pl.umap\"];\n  21 -->|anndata_out| 22;\n  4fff8ec8-7d6f-4871-9e42-d6c1791d6aa9[\"Output\\numap_leiden-clusters\"];\n  22 --> 4fff8ec8-7d6f-4871-9e42-d6c1791d6aa9;\n  style 4fff8ec8-7d6f-4871-9e42-d6c1791d6aa9 stroke:#2c3143,stroke-width:4px;\n  23[\"make_gene_matrix\"];\n  21 -->|anndata_out| 23;\n  2 -->|output| 23;\n  9a5c2e23-5b59-41ae-aceb-0e47ce9e7b1a[\"Output\\nanndata gene matrix\"];\n  23 --> 9a5c2e23-5b59-41ae-aceb-0e47ce9e7b1a;\n  style 9a5c2e23-5b59-41ae-aceb-0e47ce9e7b1a stroke:#2c3143,stroke-width:4px;\n  24[\"scanpy_filter_genes\"];\n  23 -->|anndata_out| 24;\n  7a9b22df-e0e5-49d9-9fa1-2efe316d6d66[\"Output\\nanndata filter genes\"];\n  24 --> 7a9b22df-e0e5-49d9-9fa1-2efe316d6d66;\n  style 7a9b22df-e0e5-49d9-9fa1-2efe316d6d66 stroke:#2c3143,stroke-width:4px;\n  25[\"Normalize\"];\n  24 -->|anndata_out| 25;\n  7dddd4c8-1944-4f50-b331-857d03cc9631[\"Output\\nanndata normalize\"];\n  25 --> 7dddd4c8-1944-4f50-b331-857d03cc9631;\n  style 7dddd4c8-1944-4f50-b331-857d03cc9631 stroke:#2c3143,stroke-width:4px;\n  26[\"pp.log1p\"];\n  25 -->|anndata_out| 26;\n  40ace30a-21e1-4bf2-8e08-ad93b62fb2ee[\"Output\\nanndata log1p\"];\n  26 --> 40ace30a-21e1-4bf2-8e08-ad93b62fb2ee;\n  style 40ace30a-21e1-4bf2-8e08-ad93b62fb2ee stroke:#2c3143,stroke-width:4px;\n  27[\"external.pp.magic\"];\n  26 -->|anndata_out| 27;\n  8c1c7aa9-b9dd-467b-9715-73773aea093f[\"Output\\nanndata_magic\"];\n  27 --> 8c1c7aa9-b9dd-467b-9715-73773aea093f;\n  style 8c1c7aa9-b9dd-467b-9715-73773aea093f stroke:#2c3143,stroke-width:4px;\n  28[\"Copy obsm\"];\n  21 -->|anndata_out| 28;\n  27 -->|anndata_out| 28;\n  2c3825d3-7151-4eef-97d0-c8a31ca6fd3e[\"Output\\nanndata_gene-matrix_leiden\"];\n  28 --> 2c3825d3-7151-4eef-97d0-c8a31ca6fd3e;\n  style 2c3825d3-7151-4eef-97d0-c8a31ca6fd3e stroke:#2c3143,stroke-width:4px;\n  29[\"umap_plot_with_scanpy\"];\n  28 -->|output_h5ad| 29;\n  4 -->|output| 29;\n  4cfbbb70-156b-48d7-b14b-db21198d9b6d[\"Output\\numap_marker-genes\"];\n  29 --> 4cfbbb70-156b-48d7-b14b-db21198d9b6d;\n  style 4cfbbb70-156b-48d7-b14b-db21198d9b6d stroke:#2c3143,stroke-width:4px;\n  30[\"Inspect observations\"];\n  28 -->|output_h5ad| 30;\n  31[\"Cut leiden from table\"];\n  30 -->|obs| 31;\n  11c22200-a54e-4585-82c4-8457dbbfb53c[\"Output\\nleiden annotation\"];\n  31 --> 11c22200-a54e-4585-82c4-8457dbbfb53c;\n  style 11c22200-a54e-4585-82c4-8457dbbfb53c stroke:#2c3143,stroke-width:4px;\n  32[\"Replace leiden\"];\n  31 -->|out_file1| 32;\n  5 -->|output| 32;\n  467de061-79e6-4148-8a65-c06383a14012[\"Output\\ncell type annotation\"];\n  32 --> 467de061-79e6-4148-8a65-c06383a14012;\n  style 467de061-79e6-4148-8a65-c06383a14012 stroke:#2c3143,stroke-width:4px;\n  33[\"Manipulate AnnData\"];\n  28 -->|output_h5ad| 33;\n  32 -->|outfile_replace| 33;\n  cbba6173-f439-4fd5-8423-946aa625112b[\"Output\\nanndata_cell_type\"];\n  33 --> cbba6173-f439-4fd5-8423-946aa625112b;\n  style cbba6173-f439-4fd5-8423-946aa625112b stroke:#2c3143,stroke-width:4px;\n  34[\"Plot cell types\"];\n  33 -->|anndata| 34;\n  c28c53ae-8ee7-47d7-8a00-352908bb7c1a[\"Output\\numap_cell-type\"];\n  34 --> c28c53ae-8ee7-47d7-8a00-352908bb7c1a;\n  style c28c53ae-8ee7-47d7-8a00-352908bb7c1a stroke:#2c3143,stroke-width:4px;\n  35[\"Final Anndata general info\"];\n  33 -->|anndata| 35;\n  379a85d1-a204-4b0b-8b33-86e5582fc51f[\"Output\\ngeneral\"];\n  35 --> 379a85d1-a204-4b0b-8b33-86e5582fc51f;\n  style 379a85d1-a204-4b0b-8b33-86e5582fc51f stroke:#2c3143,stroke-width:4px;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightblue,label=\"ℹ️ Input Dataset\\nFragment_file\"]\n  1[color=lightblue,label=\"ℹ️ Input Dataset\\nchromosome_sizes.tabular\"]\n  2[color=lightblue,label=\"ℹ️ Input Dataset\\ngene_annotation\"]\n  3[color=lightblue,label=\"ℹ️ Input Dataset\\nBam-file\"]\n  4[color=lightgreen,label=\"ℹ️ Input Parameter\\nKeys for annotations of obs/cells or vars/genes\"]\n  5[color=lightblue,label=\"ℹ️ Input Dataset\\nReplace_file\"]\n  6[label=\"pp.import_data\"]\n  1 -> 6 [label=\"output\"]\n  0 -> 6 [label=\"output\"]\n  7[label=\"pp.make_fragment_file\"]\n  3 -> 7 [label=\"output\"]\n  8[label=\"pl.frag_size_distr\"]\n  6 -> 8 [label=\"anndata_out\"]\n  k265d602044e2408c9eb602cbc9ac23a7[color=lightseagreen,label=\"Output\\nplot frag_size\"]\n  8 -> k265d602044e2408c9eb602cbc9ac23a7\n  9[label=\"pl.frag_size_distr_log\"]\n  6 -> 9 [label=\"anndata_out\"]\n  ka37cd3c3e07e4bea899fee44cee8370b[color=lightseagreen,label=\"Output\\nplot log frag_size\"]\n  9 -> ka37cd3c3e07e4bea899fee44cee8370b\n  10[label=\"metrics.tsse\"]\n  6 -> 10 [label=\"anndata_out\"]\n  2 -> 10 [label=\"output\"]\n  k233284e5c1844330a1d32d03951c4ce7[color=lightseagreen,label=\"Output\\nanndata tsse\"]\n  10 -> k233284e5c1844330a1d32d03951c4ce7\n  11[label=\"pp.import_data-sorted_by_barcodes\"]\n  1 -> 11 [label=\"output\"]\n  7 -> 11 [label=\"fragments_out\"]\n  k50ef9fe7bb084957bc45079ed78f9ee8[color=lightseagreen,label=\"Output\\nanndata\"]\n  11 -> k50ef9fe7bb084957bc45079ed78f9ee8\n  12[label=\"pl.tsse\"]\n  10 -> 12 [label=\"anndata_out\"]\n  k9a5c0f9c04234822871eba8317f2fa7b[color=lightseagreen,label=\"Output\\nplot tsse\"]\n  12 -> k9a5c0f9c04234822871eba8317f2fa7b\n  13[label=\"pp.filter_cells\"]\n  10 -> 13 [label=\"anndata_out\"]\n  kb58dc4ad6bf04f3199f44f8deb13427c[color=lightseagreen,label=\"Output\\nanndata filter cells\"]\n  13 -> kb58dc4ad6bf04f3199f44f8deb13427c\n  14[label=\"pp.add_tile_matrix\"]\n  13 -> 14 [label=\"anndata_out\"]\n  kd4b64fc4fd354781b7990d07fe8fe438[color=lightseagreen,label=\"Output\\nanndata tile matrix\"]\n  14 -> kd4b64fc4fd354781b7990d07fe8fe438\n  15[label=\"pp.select_features\"]\n  14 -> 15 [label=\"anndata_out\"]\n  kf531f6bd3fc648b9bb3366de7928e670[color=lightseagreen,label=\"Output\\nanndata select features\"]\n  15 -> kf531f6bd3fc648b9bb3366de7928e670\n  16[label=\"pp.scrublet\"]\n  15 -> 16 [label=\"anndata_out\"]\n  k5b17aa3a3694440f9022cf9761feb760[color=lightseagreen,label=\"Output\\nanndata scrublet\"]\n  16 -> k5b17aa3a3694440f9022cf9761feb760\n  17[label=\"pp.filter_doublets\"]\n  16 -> 17 [label=\"anndata_out\"]\n  k3838cf9da0184aa78852893b2f60ec2a[color=lightseagreen,label=\"Output\\nanndata filter doublets\"]\n  17 -> k3838cf9da0184aa78852893b2f60ec2a\n  18[label=\"tl.spectral\"]\n  17 -> 18 [label=\"anndata_out\"]\n  k778835168ac440b58b755750639d9fc4[color=lightseagreen,label=\"Output\\nanndata spectral\"]\n  18 -> k778835168ac440b58b755750639d9fc4\n  19[label=\"tl.umap\"]\n  18 -> 19 [label=\"anndata_out\"]\n  k062a54717b7a4d9bbf6cfe9bbbc5d2ad[color=lightseagreen,label=\"Output\\nanndata umap\"]\n  19 -> k062a54717b7a4d9bbf6cfe9bbbc5d2ad\n  20[label=\"pp.knn\"]\n  19 -> 20 [label=\"anndata_out\"]\n  kb7ebe580993848e587184df197126615[color=lightseagreen,label=\"Output\\nanndata knn\"]\n  20 -> kb7ebe580993848e587184df197126615\n  21[label=\"tl.leiden\"]\n  20 -> 21 [label=\"anndata_out\"]\n  k9970eb96013b4d97bbbf2d1f4663b73c[color=lightseagreen,label=\"Output\\nanndata_leiden_clustering\"]\n  21 -> k9970eb96013b4d97bbbf2d1f4663b73c\n  22[label=\"pl.umap\"]\n  21 -> 22 [label=\"anndata_out\"]\n  k4fff8ec87d6f48719e42d6c1791d6aa9[color=lightseagreen,label=\"Output\\numap_leiden-clusters\"]\n  22 -> k4fff8ec87d6f48719e42d6c1791d6aa9\n  23[label=\"make_gene_matrix\"]\n  21 -> 23 [label=\"anndata_out\"]\n  2 -> 23 [label=\"output\"]\n  k9a5c2e235b5941aeaceb0e47ce9e7b1a[color=lightseagreen,label=\"Output\\nanndata gene matrix\"]\n  23 -> k9a5c2e235b5941aeaceb0e47ce9e7b1a\n  24[label=\"scanpy_filter_genes\"]\n  23 -> 24 [label=\"anndata_out\"]\n  k7a9b22dfe0e549d99fa12efe316d6d66[color=lightseagreen,label=\"Output\\nanndata filter genes\"]\n  24 -> k7a9b22dfe0e549d99fa12efe316d6d66\n  25[label=\"Normalize\"]\n  24 -> 25 [label=\"anndata_out\"]\n  k7dddd4c819444f50b331857d03cc9631[color=lightseagreen,label=\"Output\\nanndata normalize\"]\n  25 -> k7dddd4c819444f50b331857d03cc9631\n  26[label=\"pp.log1p\"]\n  25 -> 26 [label=\"anndata_out\"]\n  k40ace30a21e14bf28e08ad93b62fb2ee[color=lightseagreen,label=\"Output\\nanndata log1p\"]\n  26 -> k40ace30a21e14bf28e08ad93b62fb2ee\n  27[label=\"external.pp.magic\"]\n  26 -> 27 [label=\"anndata_out\"]\n  k8c1c7aa9b9dd467b971573773aea093f[color=lightseagreen,label=\"Output\\nanndata_magic\"]\n  27 -> k8c1c7aa9b9dd467b971573773aea093f\n  28[label=\"Copy obsm\"]\n  21 -> 28 [label=\"anndata_out\"]\n  27 -> 28 [label=\"anndata_out\"]\n  k2c3825d371514eef97d0c8a31ca6fd3e[color=lightseagreen,label=\"Output\\nanndata_gene-matrix_leiden\"]\n  28 -> k2c3825d371514eef97d0c8a31ca6fd3e\n  29[label=\"umap_plot_with_scanpy\"]\n  28 -> 29 [label=\"output_h5ad\"]\n  4 -> 29 [label=\"output\"]\n  k4cfbbb70156b48d7b14bdb21198d9b6d[color=lightseagreen,label=\"Output\\numap_marker-genes\"]\n  29 -> k4cfbbb70156b48d7b14bdb21198d9b6d\n  30[label=\"Inspect observations\"]\n  28 -> 30 [label=\"output_h5ad\"]\n  31[label=\"Cut leiden from table\"]\n  30 -> 31 [label=\"obs\"]\n  k11c22200a54e458582c48457dbbfb53c[color=lightseagreen,label=\"Output\\nleiden annotation\"]\n  31 -> k11c22200a54e458582c48457dbbfb53c\n  32[label=\"Replace leiden\"]\n  31 -> 32 [label=\"out_file1\"]\n  5 -> 32 [label=\"output\"]\n  k467de06179e641488a65c06383a14012[color=lightseagreen,label=\"Output\\ncell type annotation\"]\n  32 -> k467de06179e641488a65c06383a14012\n  33[label=\"Manipulate AnnData\"]\n  28 -> 33 [label=\"output_h5ad\"]\n  32 -> 33 [label=\"outfile_replace\"]\n  kcbba6173f4394fd58423946aa625112b[color=lightseagreen,label=\"Output\\nanndata_cell_type\"]\n  33 -> kcbba6173f4394fd58423946aa625112b\n  34[label=\"Plot cell types\"]\n  33 -> 34 [label=\"anndata\"]\n  kc28c53ae8ee747d78a00352908bb7c1a[color=lightseagreen,label=\"Output\\numap_cell-type\"]\n  34 -> kc28c53ae8ee747d78a00352908bb7c1a\n  35[label=\"Final Anndata general info\"]\n  33 -> 35 [label=\"anndata\"]\n  k379a85d1a2044b0b8b3386e5582fc51f[color=lightseagreen,label=\"Output\\ngeneral\"]\n  35 -> k379a85d1a2044b0b8b3386e5582fc51f\n}","workflow_tools":["toolshed.g2.bx.psu.edu/repos/iuc/snapatac2_preprocessing/snapatac2_preprocessing/2.5.3+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/snapatac2_plotting/snapatac2_plotting/2.5.3+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/snapatac2_clustering/snapatac2_clustering/2.5.3+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_filter/scanpy_filter/1.9.6+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_normalize/scanpy_normalize/1.9.6+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_inspect/scanpy_inspect/1.9.6+galaxy3","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.9.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.9.6+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0","Cut1","toolshed.g2.bx.psu.edu/repos/bgruening/replace_column_by_key_value_file/replace_column_with_key_value_file/0.2","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.10.3+galaxy0"]}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scatac-standard-processing-snapatac2/tutorial.json","tools":["Cut1","toolshed.g2.bx.psu.edu/repos/bgruening/replace_column_by_key_value_file/replace_column_with_key_value_file/0.2","toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.18","toolshed.g2.bx.psu.edu/repos/devteam/cut_columns/Cut1/1.0.2","toolshed.g2.bx.psu.edu/repos/devteam/fasta_compute_length/fasta_compute_length/1.0.3","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.9.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.10.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_filter/scanpy_filter/1.9.6+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_inspect/scanpy_inspect/1.9.6+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_normalize/scanpy_normalize/1.9.6+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.9.6+galaxy3","toolshed.g2.bx.psu.edu/repos/iuc/snapatac2_clustering/snapatac2_clustering/2.5.3+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/snapatac2_peaks_and_motif/snapatac2_peaks_and_motif/2.5.3+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/snapatac2_plotting/snapatac2_plotting/2.5.3+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/snapatac2_preprocessing/snapatac2_preprocessing/2.5.3+galaxy2"],"supported_servers":{"exact":[],"inexact":[]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"replace_column_by_key_value_file","owner":"bgruening","revisions":"d533e4b75800","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bwa","owner":"devteam","revisions":"2477830927ec","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cut_columns","owner":"devteam","revisions":"cec635fab700","tool_panel_section_label":"Single Cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fasta_compute_length","owner":"devteam","revisions":"7d37cfda8e00","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_ops","owner":"ebi-gxa","revisions":"a4774b7b2e85","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_inspect","owner":"iuc","revisions":"6f0d0c784f09","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_manipulate","owner":"iuc","revisions":"ed4996a16f7f","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_filter","owner":"iuc","revisions":"d636ce5cde16","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_inspect","owner":"iuc","revisions":"f54f0f0598ad","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_normalize","owner":"iuc","revisions":"d844935c906c","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_plot","owner":"iuc","revisions":"f7446fd8d5e7","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snapatac2_clustering","owner":"iuc","revisions":"94ae400dde2f","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snapatac2_peaks_and_motif","owner":"iuc","revisions":"f9647da40db3","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snapatac2_plotting","owner":"iuc","revisions":"c01f0a08ab43","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"snapatac2_preprocessing","owner":"iuc","revisions":"48d9421bf176","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: replace_column_by_key_value_file\n  owner: bgruening\n  revisions: d533e4b75800\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bwa\n  owner: devteam\n  revisions: 2477830927ec\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cut_columns\n  owner: devteam\n  revisions: cec635fab700\n  tool_panel_section_label: Single Cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fasta_compute_length\n  owner: devteam\n  revisions: 7d37cfda8e00\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_ops\n  owner: ebi-gxa\n  revisions: a4774b7b2e85\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: 6f0d0c784f09\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_manipulate\n  owner: iuc\n  revisions: ed4996a16f7f\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_filter\n  owner: iuc\n  revisions: d636ce5cde16\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_inspect\n  owner: iuc\n  revisions: f54f0f0598ad\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_normalize\n  owner: iuc\n  revisions: d844935c906c\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_plot\n  owner: iuc\n  revisions: f7446fd8d5e7\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snapatac2_clustering\n  owner: iuc\n  revisions: 94ae400dde2f\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snapatac2_peaks_and_motif\n  owner: iuc\n  revisions: f9647da40db3\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snapatac2_plotting\n  owner: iuc\n  revisions: c01f0a08ab43\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: snapatac2_preprocessing\n  owner: iuc\n  revisions: 48d9421bf176\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Timon Schlegel","orcid":"0009-0001-3228-105X","joined":"2024-05","id":"timonschlegel","url":"https://training.galaxyproject.org/training-material/api/contributors/timonschlegel.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/timonschlegel/"},{"name":"Pavankumar Videm","orcid":"0000-0002-5192-126X","joined":"2017-09","affiliations":["uni-freiburg","elixir-europe"],"id":"pavanvidem","url":"https://training.galaxyproject.org/training-material/api/contributors/pavanvidem.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pavanvidem/"},{"name":"Björn Grüning","email":"bjoern.gruening@gmail.com","twitter":"bjoerngruening","fediverse":"https://fosstodon.org/@bgruening","fediverse_flavor":"mastodon","matrix":"bgruening:matrix.org","orcid":"0000-0002-3079-6586","elixir_node":"de","linkedin":"bgruening","contact_for_training":true,"joined":"2017-09","location":{"country":"DE","lat":47.997791,"lon":7.842609},"affiliations":["eurosciencegateway","eosc-life","by-covid","deNBI","sfb992","elixir-converge","uni-freiburg","elixir-europe"],"id":"bgruening","url":"https://training.galaxyproject.org/training-material/api/contributors/bgruening.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bgruening/"},{"name":"Pavankumar Videm","orcid":"0000-0002-5192-126X","joined":"2017-09","affiliations":["uni-freiburg","elixir-europe"],"id":"pavanvidem","url":"https://training.galaxyproject.org/training-material/api/contributors/pavanvidem.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pavanvidem/"}]}