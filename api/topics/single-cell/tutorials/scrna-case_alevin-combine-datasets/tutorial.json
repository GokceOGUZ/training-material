{"layout":"tutorial_hands_on","title":"Combining single cell datasets after pre-processing","subtopic":"single-cell-CS","priority":2,"zenodo_link":"https://zenodo.org/records/10852529","questions":["I have some AnnData files from different samples that I want to combine into a single file. How can I combine these and label them within the object?"],"redirect_from":["/topics/transcriptomics/tutorials/scrna-case_alevin-combine-datasets/tutorial","/short/single-cell/scrna-case_alevin-combine-datasets","/short/T00246"],"answer_histories":[{"label":"UseGalaxy.eu","history":"https://usegalaxy.eu/u/j.jakiela/h/combining-datasets-key-history","date":"2024-03-26"},{"label":"All total samples - processed after Alevin into single object (UseGalaxy.eu)","history":"https://usegalaxy.eu/u/j.jakiela/h/all-total-samples-processed-after-alevin-into-single-object","date":"2024-03-26"}],"input_histories":[{"label":"UseGalaxy.eu","history":"https://usegalaxy.eu/u/j.jakiela/h/combining-datasets-input"},{"label":"UseGalaxy.org","history":"https://usegalaxy.org/u/juliajot/h/combining-datasets-input"}],"objectives":["Combine data matrices from different samples in the same experiment","Label the metadata for downstream processing"],"time_estimation":"1H","key_points":["Create a single scanpy-accessible AnnData object from multiple AnnData files, including relevant cell metadata according to the study design","Retreive partially analysed data from a public repository"],"tags":["10x","paper-replication"],"contributions":{"authorship":["nomadscientist","pinin4fjords"],"editing":["hexylena"],"testing":["wee-snufkin"]},"requirements":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-intro","scrna-umis","scrna-case_alevin"]}],"gitter":"Galaxy-Training-Network/galaxy-single-cell","follow_up_training":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-case_basic-pipeline"]}],"recordings":[{"youtube_id":"22t-4qvHnow","length":"11M","date":"2023-05-09","speakers":["hrukkudyr"],"captioners":["hrukkudyr"]},{"captioners":["nomadscientist"],"date":"2021-02-15","galaxy_version":"21.09","length":"11M","youtube_id":"U8pVa6csmUE","speakers":["nomadscientist"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00246","url":"/topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/tutorial.html","topic_name":"single-cell","tutorial_name":"scrna-case_alevin-combine-datasets","dir":"topics/single-cell/tutorials/scrna-case_alevin-combine-datasets","symlink":null,"id":"single-cell/scrna-case_alevin-combine-datasets","hands_on":true,"slides":false,"mod_date":"2024-06-13 18:07:31 +0000","pub_date":"2022-09-08 14:00:12 +0000","version":35,"workflows":[{"workflow":"Combining-datasets-after-pre-processing.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/workflows/Combining-datasets-after-pre-processing.ga","url_html":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/workflows/Combining-datasets-after-pre-processing.html","path":"topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/workflows/Combining-datasets-after-pre-processing.ga","wfid":"single-cell-scrna-case_alevin-combine-datasets","wfname":"combining-datasets-after-pre-processing","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_alevin-combine-datasets/versions/combining-datasets-after-pre-processing","license":"CC-BY-4.0","parent_id":"single-cell/scrna-case_alevin-combine-datasets","topic_id":"single-cell","tutorial_id":"scrna-case_alevin-combine-datasets","creators":[{"class":"Person","identifier":"0009-0001-2017-8805","name":"Julia Jakiela"},{"class":"Person","identifier":"0000-0002-8170-8806","name":"Wendi Bacon"}],"name":"Combining datasets after pre-processing","title":"Combining datasets after pre-processing","version":1,"description":"Updated March 2024","tags":["name:training","name:single-cell"],"features":{"report":null,"subworkflows":false,"comments":false,"parameters":false},"workflowhub_id":"1225","history":[{"hash":"923c71c756c805a4ce7f2b794fa721aa6a4966f4","unix":"1711487790","message":"workflow tests","short_hash":"923c71c75","num":1}],"test_results":null,"modified":"2024-07-12 11:38:43 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nN701\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nN702\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nN703\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nN704\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"ℹ️ Input Dataset\\nN705\"];\n  style 4 stroke:#2c3143,stroke-width:4px;\n  5[\"ℹ️ Input Dataset\\nN706\"];\n  style 5 stroke:#2c3143,stroke-width:4px;\n  6[\"ℹ️ Input Dataset\\nN707\"];\n  style 6 stroke:#2c3143,stroke-width:4px;\n  7[\"Concatenating Datasets\"];\n  0 -->|output| 7;\n  1 -->|output| 7;\n  2 -->|output| 7;\n  3 -->|output| 7;\n  4 -->|output| 7;\n  5 -->|output| 7;\n  6 -->|output| 7;\n  168d4710-570a-43b1-998a-2164154eebc5[\"Output\\nCombined Object\"];\n  7 --> 168d4710-570a-43b1-998a-2164154eebc5;\n  style 168d4710-570a-43b1-998a-2164154eebc5 stroke:#2c3143,stroke-width:4px;\n  8[\"Inspect AnnData\"];\n  7 -->|anndata| 8;\n  9[\"Inspect AnnData\"];\n  7 -->|anndata| 9;\n  10[\"Inspect AnnData\"];\n  7 -->|anndata| 10;\n  11[\"Replace Text\"];\n  9 -->|obs| 11;\n  12[\"Replace Text\"];\n  9 -->|obs| 12;\n  13[\"Cut\"];\n  11 -->|outfile| 13;\n  8b026c35-f9db-4bcd-8cf5-54b7d6fb5aea[\"Output\\nSex metadata\"];\n  13 --> 8b026c35-f9db-4bcd-8cf5-54b7d6fb5aea;\n  style 8b026c35-f9db-4bcd-8cf5-54b7d6fb5aea stroke:#2c3143,stroke-width:4px;\n  14[\"Cut\"];\n  12 -->|outfile| 14;\n  6f55548b-5ded-42b8-b2f7-c7f1a327a068[\"Output\\nGenotype metadata\"];\n  14 --> 6f55548b-5ded-42b8-b2f7-c7f1a327a068;\n  style 6f55548b-5ded-42b8-b2f7-c7f1a327a068 stroke:#2c3143,stroke-width:4px;\n  15[\"Paste\"];\n  14 -->|out_file1| 15;\n  13 -->|out_file1| 15;\n  2f0ea0f3-f2f7-44b2-b8f0-05d8cbb364a6[\"Output\\nCell metadata\"];\n  15 --> 2f0ea0f3-f2f7-44b2-b8f0-05d8cbb364a6;\n  style 2f0ea0f3-f2f7-44b2-b8f0-05d8cbb364a6 stroke:#2c3143,stroke-width:4px;\n  16[\"Adding in cell metadata\"];\n  7 -->|anndata| 16;\n  15 -->|out_file1| 16;\n  2720386c-7273-49d6-abb0-9bd14f6cb68c[\"Output\\nAnnData with Cell Metadata\"];\n  16 --> 2720386c-7273-49d6-abb0-9bd14f6cb68c;\n  style 2720386c-7273-49d6-abb0-9bd14f6cb68c stroke:#2c3143,stroke-width:4px;\n  17[\"Batching Cell Metadata\"];\n  16 -->|anndata| 17;\n  b950c8db-abe1-4cb0-af58-d291d3b74a83[\"Output\\nBatched Object\"];\n  17 --> b950c8db-abe1-4cb0-af58-d291d3b74a83;\n  style b950c8db-abe1-4cb0-af58-d291d3b74a83 stroke:#2c3143,stroke-width:4px;\n  18[\"Calculating mitochondrial \"];\n  17 -->|anndata| 18;\n  2417284d-8252-43ff-84bf-6f15ef11cd05[\"Output\\nAnnotated AnnData\"];\n  18 --> 2417284d-8252-43ff-84bf-6f15ef11cd05;\n  style 2417284d-8252-43ff-84bf-6f15ef11cd05 stroke:#2c3143,stroke-width:4px;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightblue,label=\"ℹ️ Input Dataset\\nN701\"]\n  1[color=lightblue,label=\"ℹ️ Input Dataset\\nN702\"]\n  2[color=lightblue,label=\"ℹ️ Input Dataset\\nN703\"]\n  3[color=lightblue,label=\"ℹ️ Input Dataset\\nN704\"]\n  4[color=lightblue,label=\"ℹ️ Input Dataset\\nN705\"]\n  5[color=lightblue,label=\"ℹ️ Input Dataset\\nN706\"]\n  6[color=lightblue,label=\"ℹ️ Input Dataset\\nN707\"]\n  7[label=\"Concatenating Datasets\"]\n  0 -> 7 [label=\"output\"]\n  1 -> 7 [label=\"output\"]\n  2 -> 7 [label=\"output\"]\n  3 -> 7 [label=\"output\"]\n  4 -> 7 [label=\"output\"]\n  5 -> 7 [label=\"output\"]\n  6 -> 7 [label=\"output\"]\n  k168d4710570a43b1998a2164154eebc5[color=lightseagreen,label=\"Output\\nCombined Object\"]\n  7 -> k168d4710570a43b1998a2164154eebc5\n  8[label=\"Inspect AnnData\"]\n  7 -> 8 [label=\"anndata\"]\n  9[label=\"Inspect AnnData\"]\n  7 -> 9 [label=\"anndata\"]\n  10[label=\"Inspect AnnData\"]\n  7 -> 10 [label=\"anndata\"]\n  11[label=\"Replace Text\"]\n  9 -> 11 [label=\"obs\"]\n  12[label=\"Replace Text\"]\n  9 -> 12 [label=\"obs\"]\n  13[label=\"Cut\"]\n  11 -> 13 [label=\"outfile\"]\n  k8b026c35f9db4bcd8cf554b7d6fb5aea[color=lightseagreen,label=\"Output\\nSex metadata\"]\n  13 -> k8b026c35f9db4bcd8cf554b7d6fb5aea\n  14[label=\"Cut\"]\n  12 -> 14 [label=\"outfile\"]\n  k6f55548b5ded42b8b2f7c7f1a327a068[color=lightseagreen,label=\"Output\\nGenotype metadata\"]\n  14 -> k6f55548b5ded42b8b2f7c7f1a327a068\n  15[label=\"Paste\"]\n  14 -> 15 [label=\"out_file1\"]\n  13 -> 15 [label=\"out_file1\"]\n  k2f0ea0f3f2f744b2b8f005d8cbb364a6[color=lightseagreen,label=\"Output\\nCell metadata\"]\n  15 -> k2f0ea0f3f2f744b2b8f005d8cbb364a6\n  16[label=\"Adding in cell metadata\"]\n  7 -> 16 [label=\"anndata\"]\n  15 -> 16 [label=\"out_file1\"]\n  k2720386c727349d6abb09bd14f6cb68c[color=lightseagreen,label=\"Output\\nAnnData with Cell Metadata\"]\n  16 -> k2720386c727349d6abb09bd14f6cb68c\n  17[label=\"Batching Cell Metadata\"]\n  16 -> 17 [label=\"anndata\"]\n  kb950c8dbabe14cb0af58d291d3b74a83[color=lightseagreen,label=\"Output\\nBatched Object\"]\n  17 -> kb950c8dbabe14cb0af58d291d3b74a83\n  18[label=\"Calculating mitochondrial \"]\n  17 -> 18 [label=\"anndata\"]\n  k2417284d825243ff84bf6f15ef11cd05[color=lightseagreen,label=\"Output\\nAnnotated AnnData\"]\n  18 -> k2417284d825243ff84bf6f15ef11cd05\n}","workflow_tools":["toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.10.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/9.3+galaxy0","Cut1","Paste1","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.9.3+galaxy0"]}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-case_alevin-combine-datasets/tutorial.json","tools":["Cut1","Paste1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/9.3+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/1.9.3+galaxy0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/retrieve_scxa/retrieve_scxa/v0.0.2+galaxy2","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.8.1+galaxy9","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.10.3+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.10.3+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true},{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"12615d397df7","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_ops","owner":"ebi-gxa","revisions":"a4774b7b2e85","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"retrieve_scxa","owner":"ebi-gxa","revisions":"72b6e1747e37","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_read_10x","owner":"ebi-gxa","revisions":"9afcfcd1d215","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_inspect","owner":"iuc","revisions":"6f0d0c784f09","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_inspect","owner":"iuc","revisions":"ee98d611afc6","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_manipulate","owner":"iuc","revisions":"ed4996a16f7f","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: 12615d397df7\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_ops\n  owner: ebi-gxa\n  revisions: a4774b7b2e85\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: retrieve_scxa\n  owner: ebi-gxa\n  revisions: 72b6e1747e37\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_read_10x\n  owner: ebi-gxa\n  revisions: 9afcfcd1d215\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: 6f0d0c784f09\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: ee98d611afc6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_manipulate\n  owner: iuc\n  revisions: ed4996a16f7f\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Wendi Bacon","email":"wendi.bacon@open.ac.uk","twitter":"WendiBacon1","matrix":"nomadscientist:matrix.org","joined":"2020-03","elixir_node":"uk","orcid":"0000-0002-8170-8806","bio":"Senior Lecturer at The Open University","fediverse":"https://mstdn.science/@wendibacon1","fediverse_flavor":"mastodon","affiliations":["elixir-europe"],"id":"nomadscientist","url":"https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"},{"name":"Jonathan Manning","email":"jmanning@ebi.ac.uk","joined":"2021-02","id":"pinin4fjords","url":"https://training.galaxyproject.org/training-material/api/contributors/pinin4fjords.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/pinin4fjords/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Julia Jakiela","email":"juliajot36@gmail.com","joined":"2022-06","id":"wee-snufkin","url":"https://training.galaxyproject.org/training-material/api/contributors/wee-snufkin.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/wee-snufkin/"}]}