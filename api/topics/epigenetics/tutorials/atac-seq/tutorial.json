{"layout":"tutorial_hands_on","title":"ATAC-Seq data analysis","zenodo_link":"https://zenodo.org/record/3862793","questions":["Which DNA regions are accessible in the human lymphoblastoid cell line GM12878?","How to analyse and visualise ATAC-Seq data?"],"objectives":["Apply appropriate analysis and quality control steps for ATAC-Seq","Generate a heatmap of transcription start site accessibility","Visualise peaks for specific regions"],"time_estimation":"3h","key_points":["ATAC-Seq can be used to identify accessible gene promoters and enhancers","Several filters are applied to the reads, such as removing those mapped to mitochondria","Fragment distribution can help determine whether an ATAC-Seq experiment has worked well"],"contributors":[{"name":"Lucille Delisle","email":"lucille.delisle@epfl.ch","orcid":"0000-0002-1964-4960","joined":"2019-08","elixir_node":"ch","contact_for_training":true,"location":{"country":"CH","lat":46.52,"lon":6.56},"affiliations":["elixir-europe"],"id":"lldelisle","url":"https://training.galaxyproject.org/training-material/api/contributors/lldelisle.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/lldelisle/"},{"name":"Maria Doyle","joined":"2018-09","orcid":"0000-0003-4847-8436","id":"mblue9","url":"https://training.galaxyproject.org/training-material/api/contributors/mblue9.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mblue9/"},{"name":"Florian Heyl","joined":"2018-08","elixir_node":"de","orcid":"0000-0002-3651-5685","former_affiliations":["uni-freiburg","elixir-europe"],"id":"heylf","url":"https://training.galaxyproject.org/training-material/api/contributors/heylf.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/heylf/"}],"recordings":[{"captioners":["hrhotz"],"date":"2021-02-15","galaxy_version":"21.01","length":"1H50M","youtube_id":"Zc-bl6ZfcX4","speakers":["heylf"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00137","url":"/topics/epigenetics/tutorials/atac-seq/tutorial.html","topic_name":"epigenetics","tutorial_name":"atac-seq","dir":"topics/epigenetics/tutorials/atac-seq","symlink":null,"id":"epigenetics/atac-seq","hands_on":true,"slides":true,"mod_date":"2024-06-14 09:56:50 +0000","pub_date":"2019-09-02 16:17:33 +0000","version":23,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/epigenetics/tutorials/atac-seq/workflows/main_workflow.ga","url_html":"https://training.galaxyproject.org/training-material/topics/epigenetics/tutorials/atac-seq/workflows/main_workflow.html","path":"topics/epigenetics/tutorials/atac-seq/workflows/main_workflow.ga","wfid":"epigenetics-atac-seq","wfname":"main-workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/epigenetics-atac-seq/versions/main-workflow","license":null,"parent_id":"epigenetics/atac-seq","topic_id":"epigenetics","tutorial_id":"atac-seq","creators":[],"name":"ATAC-seq GTM","title":"ATAC-seq GTM","version":10,"description":"atac-seq\n","tags":["epigenetics"],"features":{"report":null,"subworkflows":false,"comments":false,"parameters":false},"workflowhub_id":"1169","history":[{"hash":"96d212779f2fbe4abf7c850b750ca5e163e88361","unix":"1619713579","message":"update deeptools tools + parameters","short_hash":"96d212779","num":20},{"hash":"ba3bf335e18101d6178afceebe7226c14c1153c4","unix":"1618238510","message":"use pygenometracks 3.6","short_hash":"ba3bf335e","num":19},{"hash":"af99da9c03f900d2c078b704c84993c64d9cf722","unix":"1617381749","message":"update the workflow","short_hash":"af99da9c0","num":18},{"hash":"d5cd0ab560e9922b159174141905919870659041","unix":"1617118406","message":"update tutorial","short_hash":"d5cd0ab56","num":17},{"hash":"d4aee8b0dee08824c24db20abb73078b27d46b2e","unix":"1592298126","message":"change bedtools to allow to sort encodePeak","short_hash":"d4aee8b0d","num":16},{"hash":"c1cf1143c8c7aa6fbd822761682cd94d95588b82","unix":"1591860137","message":"macs2 to MACS2 in figures and workflow","short_hash":"c1cf1143c","num":15},{"hash":"69d703ece4379791461043ed5d78dee4b2a9a724","unix":"1591855841","message":"add tag and annotation","short_hash":"69d703ece","num":14},{"hash":"83f254a2b6d7ab6dd0677111eca534d4fd70aa21","unix":"1591824498","message":"update new version of pgt","short_hash":"83f254a2b","num":13},{"hash":"667ff3de9c4e13d341a6d864bd6dc826ef15ca04","unix":"1579690769","message":"annotation","short_hash":"667ff3de9","num":12},{"hash":"eb4d724e0064c77beb20efa626a0f28fd0500676","unix":"1579084895","message":"Workflow renaming","short_hash":"eb4d724e0","num":11},{"hash":"05fb8eedbed86a986f9bc87a8bdfedd4093acc75","unix":"1576835747","message":"New workflows unflattened","short_hash":"05fb8eedb","num":10},{"hash":"2ebad4e591be9976da3c76fac328910cbb532b53","unix":"1576835604","message":"rebase","short_hash":"2ebad4e59","num":9},{"hash":"bc9c7ce8a01c0205beb6267bcd866330acc1747f","unix":"1576770705","message":"changed awk step","short_hash":"bc9c7ce8a","num":8},{"hash":"1bef60c2de1f1a8f7b43814a18a9b4378a7433ba","unix":"1576768651","message":"updated workflow","short_hash":"1bef60c2d","num":7},{"hash":"faf6d298afa752b6676a1533854c634efefe8075","unix":"1576155753","message":"unflatten workflows","short_hash":"faf6d298a","num":6},{"hash":"397de5ef9638f7e38137e143e575a87e13443089","unix":"1566912825","message":"modified version of genrich and pygenometracks","short_hash":"397de5ef9","num":5},{"hash":"93027360bcbac79c5e7d2eec481679d9ab09a159","unix":"1565856529","message":"Changes to workflow atac","short_hash":"93027360b","num":4},{"hash":"b2bcfc0d7fbfc45e055185515a5ba99b86ba4b00","unix":"1562416848","message":"Add visualisation step to workflow (pygenometracks)","short_hash":"b2bcfc0d7","num":3},{"hash":"7dec9b919382dc05ac8e1a717ca8e70078ea343e","unix":"1562336122","message":"Updates to workflow","short_hash":"7dec9b919","num":2},{"hash":"bb008c8c916d026929795969c28763b1cddfbfd1","unix":"1562333044","message":"First draft of ATAC-seq tut from CoFest (WIP)","short_hash":"bb008c8c9","num":1}],"test_results":null,"modified":"2024-07-16 08:09:59 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nbed file with genes\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nctcf peaks\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nATAC R2 read in fastq.gz format\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nATAC R1 read in fastq.gz format\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"Filter\"];\n  1 -->|output| 4;\n  5[\"FastQC\"];\n  2 -->|output| 5;\n  6[\"ATAC remove nextera adapters with cutadapt\"];\n  3 -->|output| 6;\n  2 -->|output| 6;\n  7[\"FastQC\"];\n  3 -->|output| 7;\n  8[\"bedtools Intersect intervals\"];\n  4 -->|out_file1| 8;\n  0 -->|output| 8;\n  9[\"FastQC\"];\n  6 -->|out2| 9;\n  10[\"Bowtie2\"];\n  6 -->|out1| 10;\n  6 -->|out2| 10;\n  11[\"FastQC\"];\n  6 -->|out1| 11;\n  12[\"Filter BAM ATAC\"];\n  10 -->|output| 12;\n  13[\"MarkDuplicates\"];\n  12 -->|out_file1| 13;\n  14[\"bedtools BAM to BED\"];\n  13 -->|outFile| 14;\n  15[\"Paired-end histogram\"];\n  13 -->|outFile| 15;\n  16[\"MACS2 callpeak\"];\n  14 -->|output| 16;\n  17[\"Wig/BedGraph-to-bigWig\"];\n  16 -->|output_treat_pileup| 17;\n  18[\"computeMatrix\"];\n  17 -->|out_file1| 18;\n  0 -->|output| 18;\n  19[\"pyGenomeTracks\"];\n  17 -->|out_file1| 19;\n  16 -->|output_narrowpeaks| 19;\n  0 -->|output| 19;\n  1 -->|output| 19;\n  20[\"computeMatrix\"];\n  17 -->|out_file1| 20;\n  8 -->|output| 20;\n  65159c9c-050b-4069-8704-8f66c0563a98[\"Output\\ncomputeMatrix on input dataset(s): Matrix\"];\n  20 --> 65159c9c-050b-4069-8704-8f66c0563a98;\n  style 65159c9c-050b-4069-8704-8f66c0563a98 stroke:#2c3143,stroke-width:4px;\n  21[\"plotHeatmap\"];\n  18 -->|outFileName| 21;\n  22[\"plotHeatmap\"];\n  20 -->|outFileName| 22;\n  74a36643-b88f-4378-8f9c-c1b20ee2651e[\"Output\\nplotHeatmap on input dataset(s): Image\"];\n  22 --> 74a36643-b88f-4378-8f9c-c1b20ee2651e;\n  style 74a36643-b88f-4378-8f9c-c1b20ee2651e stroke:#2c3143,stroke-width:4px;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightblue,label=\"ℹ️ Input Dataset\\nbed file with genes\"]\n  1[color=lightblue,label=\"ℹ️ Input Dataset\\nctcf peaks\"]\n  2[color=lightblue,label=\"ℹ️ Input Dataset\\nATAC R2 read in fastq.gz format\"]\n  3[color=lightblue,label=\"ℹ️ Input Dataset\\nATAC R1 read in fastq.gz format\"]\n  4[label=\"Filter\"]\n  1 -> 4 [label=\"output\"]\n  5[label=\"FastQC\"]\n  2 -> 5 [label=\"output\"]\n  6[label=\"ATAC remove nextera adapters with cutadapt\"]\n  3 -> 6 [label=\"output\"]\n  2 -> 6 [label=\"output\"]\n  7[label=\"FastQC\"]\n  3 -> 7 [label=\"output\"]\n  8[label=\"bedtools Intersect intervals\"]\n  4 -> 8 [label=\"out_file1\"]\n  0 -> 8 [label=\"output\"]\n  9[label=\"FastQC\"]\n  6 -> 9 [label=\"out2\"]\n  10[label=\"Bowtie2\"]\n  6 -> 10 [label=\"out1\"]\n  6 -> 10 [label=\"out2\"]\n  11[label=\"FastQC\"]\n  6 -> 11 [label=\"out1\"]\n  12[label=\"Filter BAM ATAC\"]\n  10 -> 12 [label=\"output\"]\n  13[label=\"MarkDuplicates\"]\n  12 -> 13 [label=\"out_file1\"]\n  14[label=\"bedtools BAM to BED\"]\n  13 -> 14 [label=\"outFile\"]\n  15[label=\"Paired-end histogram\"]\n  13 -> 15 [label=\"outFile\"]\n  16[label=\"MACS2 callpeak\"]\n  14 -> 16 [label=\"output\"]\n  17[label=\"Wig/BedGraph-to-bigWig\"]\n  16 -> 17 [label=\"output_treat_pileup\"]\n  18[label=\"computeMatrix\"]\n  17 -> 18 [label=\"out_file1\"]\n  0 -> 18 [label=\"output\"]\n  19[label=\"pyGenomeTracks\"]\n  17 -> 19 [label=\"out_file1\"]\n  16 -> 19 [label=\"output_narrowpeaks\"]\n  0 -> 19 [label=\"output\"]\n  1 -> 19 [label=\"output\"]\n  20[label=\"computeMatrix\"]\n  17 -> 20 [label=\"out_file1\"]\n  8 -> 20 [label=\"output\"]\n  k65159c9c050b406987048f66c0563a98[color=lightseagreen,label=\"Output\\ncomputeMatrix on input dataset(s): Matrix\"]\n  20 -> k65159c9c050b406987048f66c0563a98\n  21[label=\"plotHeatmap\"]\n  18 -> 21 [label=\"outFileName\"]\n  22[label=\"plotHeatmap\"]\n  20 -> 22 [label=\"outFileName\"]\n  k74a36643b88f43788f9cc1b20ee2651e[color=lightseagreen,label=\"Output\\nplotHeatmap on input dataset(s): Image\"]\n  22 -> k74a36643b88f43788f9cc1b20ee2651e\n}","workflow_tools":["Filter1","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1","toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/1.16.5","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.30.0","toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.4.2+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.4.1","toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.30.0","toolshed.g2.bx.psu.edu/repos/iuc/pe_histogram/pe_histogram/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.1.1.20160309.6","wig_to_bigWig","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0","toolshed.g2.bx.psu.edu/repos/iuc/pygenometracks/pygenomeTracks/3.6","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1"]}],"api":"https://training.galaxyproject.org/training-material/api/topics/epigenetics/tutorials/atac-seq/tutorial.json","tools":["Cut1","Filter1","Grep1","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0","toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_sort_header_tool/1.1.1","toolshed.g2.bx.psu.edu/repos/devteam/bamtools_filter/bamFilter/2.4.1","toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.4.2+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1","toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2","toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.3","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_bamtobed/2.30.0","toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.30.0","toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.1.1.20160309.6","toolshed.g2.bx.psu.edu/repos/iuc/pe_histogram/pe_histogram/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/pygenometracks/pygenomeTracks/3.6","toolshed.g2.bx.psu.edu/repos/lparsons/cutadapt/cutadapt/1.16.5","wig_to_bigWig"],"supported_servers":{"exact":[{"url":"https://usegalaxy.be/","name":"UseGalaxy.be","usegalaxy":false}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false}]},"topic_name_human":"Epigenetics","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"deeptools_compute_matrix","owner":"bgruening","revisions":"514fa53b5efb","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"deeptools_plot_heatmap","owner":"bgruening","revisions":"a4dfb122e52b","tool_panel_section_label":"deepTools","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bamtools_filter","owner":"devteam","revisions":"cb20f99fd45b","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bowtie2","owner":"devteam","revisions":"a6d65b0c67af","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"fastqc","owner":"devteam","revisions":"e7b2202befea","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"picard","owner":"devteam","revisions":"a1f0b3f4b781","tool_panel_section_label":"Picard","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_idxstats","owner":"devteam","revisions":"7a6034296ae9","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"ce3c7f062223","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bedtools","owner":"iuc","revisions":"a68aa6c1204a","tool_panel_section_label":"BED","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"macs2","owner":"iuc","revisions":"424aefbd7777","tool_panel_section_label":"Peak Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"pe_histogram","owner":"iuc","revisions":"bd1416eea1f0","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"pygenometracks","owner":"iuc","revisions":"2824d77cd8f8","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"cutadapt","owner":"lparsons","revisions":"49370cb85f0f","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: deeptools_compute_matrix\n  owner: bgruening\n  revisions: 514fa53b5efb\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: deeptools_plot_heatmap\n  owner: bgruening\n  revisions: a4dfb122e52b\n  tool_panel_section_label: deepTools\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bamtools_filter\n  owner: devteam\n  revisions: cb20f99fd45b\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bowtie2\n  owner: devteam\n  revisions: a6d65b0c67af\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: fastqc\n  owner: devteam\n  revisions: e7b2202befea\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: picard\n  owner: devteam\n  revisions: a1f0b3f4b781\n  tool_panel_section_label: Picard\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_idxstats\n  owner: devteam\n  revisions: 7a6034296ae9\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: ce3c7f062223\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bedtools\n  owner: iuc\n  revisions: a68aa6c1204a\n  tool_panel_section_label: BED\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: macs2\n  owner: iuc\n  revisions: 424aefbd7777\n  tool_panel_section_label: Peak Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: pe_histogram\n  owner: iuc\n  revisions: bd1416eea1f0\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: pygenometracks\n  owner: iuc\n  revisions: 2824d77cd8f8\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: cutadapt\n  owner: lparsons\n  revisions: 49370cb85f0f\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":true,"slides_recordings":[{"captioners":["lldelisle"],"date":"2021-02-15","galaxy_version":"21.01","length":"15M","youtube_id":"2jPNNd5YJNM","speakers":["lldelisle"]}],"translations":{"tutorial":[],"slides":[],"video":true},"license":"CC-BY-4.0","type":"tutorial"}