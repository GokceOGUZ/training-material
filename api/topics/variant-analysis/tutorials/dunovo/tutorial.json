{"layout":"tutorial_hands_on","title":"Calling very rare variants","subtopic":"introduction","zenodo_link":"","draft":true,"questions":["What frequency of variants is so low that it is obscured by sequencing error rate?","What are the different types of consensus sequences produced from duplex sequencing?"],"objectives":["Processing raw duplex sequencing data into consensus sequences","Find rare variants without relying on diploid assumptions"],"time_estimation":"3h","key_points":["Diploid variant calling relies on assumptions that rare variant calling cannot make","Duplex consensus sequences are usually most accurate, but sometimes you must rely on single-strand consensus sequences instead."],"contributors":[{"name":"Anton Nekrutenko","email":"anton@nekrut.org","joined":"2017-09","id":"nekrut","url":"https://training.galaxyproject.org/training-material/api/contributors/nekrut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nekrut/"},{"name":"Nick Stoler","twitter":"NickStoler","joined":"2018-07","id":"NickSto","url":"https://training.galaxyproject.org/training-material/api/contributors/NickSto.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/NickSto/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00310","url":"/topics/variant-analysis/tutorials/dunovo/tutorial.html","topic_name":"variant-analysis","tutorial_name":"dunovo","dir":"topics/variant-analysis/tutorials/dunovo","symlink":null,"id":"variant-analysis/dunovo","hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2017-02-22 11:51:41 +0000","version":30,"workflows":[{"workflow":"dunovo.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/dunovo/workflows/dunovo.ga","url_html":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/dunovo/workflows/dunovo.html","path":"topics/variant-analysis/tutorials/dunovo/workflows/dunovo.ga","wfid":"variant-analysis-dunovo","wfname":"dunovo","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/variant-analysis-dunovo/versions/dunovo","license":null,"parent_id":"variant-analysis/dunovo","topic_id":"variant-analysis","tutorial_id":"dunovo","creators":[],"name":"Du Novo GTN Tutorial - Make Consensus Sequences","title":"Du Novo GTN Tutorial - Make Consensus Sequences","version":3,"description":"Run this on raw duplex sequencing reads to produce duplex consensus sequences.\n","tags":["variant-analysis"],"features":{"report":null,"subworkflows":false,"comments":false,"parameters":false},"workflowhub_id":"1086","history":[{"hash":"eb4d724e0064c77beb20efa626a0f28fd0500676","unix":"1579084895","message":"Workflow renaming","short_hash":"eb4d724e0","num":3},{"hash":"361236c416497d2d9f2735d64f8c43050a5a5a4e","unix":"1554368414","message":"Changed format of workflows","short_hash":"361236c41","num":2},{"hash":"76979680776eafe50610d00238ad8b00da835c7c","unix":"1532662117","message":"Update rare variant calling tutorial for GTN consistency and new tool version. - Format to be more consistent with other GTN tutorials. - Update to work with newer version of Du Novo (2.15 instead of 0.3). - Restructure logic and flow, add more explanations. - Add workflow files.","short_hash":"769796807","num":1}],"test_results":null,"modified":"2024-07-15 09:26:23 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nSRR1799908_forward\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nSRR1799908_reverse\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Du Novo: Make families\"];\n  0 -->|output| 2;\n  1 -->|output| 2;\n  3[\"Du Novo: Correct barcodes\"];\n  2 -->|output| 3;\n  4[\"Du Novo: Align families\"];\n  3 -->|output| 4;\n  5[\"Du Novo: Make consensus reads\"];\n  4 -->|output| 5;\n  6[\"DCS: Sequence Content Trimmer\"];\n  5 -->|dcs1| 6;\n  5 -->|dcs2| 6;\n  7[\"SSCS: Sequence Content Trimmer\"];\n  5 -->|sscs1| 7;\n  5 -->|sscs2| 7;\n  75dfe52d-711e-4826-ba9b-b4feed30f5bf[\"Output\\n\"];\n  7 --> 75dfe52d-711e-4826-ba9b-b4feed30f5bf;\n  style 75dfe52d-711e-4826-ba9b-b4feed30f5bf stroke:#2c3143,stroke-width:4px;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightblue,label=\"ℹ️ Input Dataset\\nSRR1799908_forward\"]\n  1[color=lightblue,label=\"ℹ️ Input Dataset\\nSRR1799908_reverse\"]\n  2[label=\"Du Novo: Make families\"]\n  0 -> 2 [label=\"output\"]\n  1 -> 2 [label=\"output\"]\n  3[label=\"Du Novo: Correct barcodes\"]\n  2 -> 3 [label=\"output\"]\n  4[label=\"Du Novo: Align families\"]\n  3 -> 4 [label=\"output\"]\n  5[label=\"Du Novo: Make consensus reads\"]\n  4 -> 5 [label=\"output\"]\n  6[label=\"DCS: Sequence Content Trimmer\"]\n  5 -> 6 [label=\"dcs1\"]\n  5 -> 6 [label=\"dcs2\"]\n  7[label=\"SSCS: Sequence Content Trimmer\"]\n  5 -> 7 [label=\"sscs1\"]\n  5 -> 7 [label=\"sscs2\"]\n  k75dfe52d711e4826ba9bb4feed30f5bf[color=lightseagreen,label=\"Output\\n\"]\n  7 -> k75dfe52d711e4826ba9bb4feed30f5bf\n}","workflow_tools":["toolshed.g2.bx.psu.edu/repos/nick/dunovo/make_families/2.15","toolshed.g2.bx.psu.edu/repos/nick/dunovo/correct_barcodes/2.15","toolshed.g2.bx.psu.edu/repos/nick/dunovo/align_families/2.15","toolshed.g2.bx.psu.edu/repos/nick/dunovo/dunovo/2.15","toolshed.g2.bx.psu.edu/repos/nick/sequence_content_trimmer/sequence_content_trimmer/0.1"]},{"workflow":"variant-calling.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/dunovo/workflows/variant-calling.ga","url_html":"https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/dunovo/workflows/variant-calling.html","path":"topics/variant-analysis/tutorials/dunovo/workflows/variant-calling.ga","wfid":"variant-analysis-dunovo","wfname":"variant-calling","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/variant-analysis-dunovo/versions/variant-calling","license":null,"parent_id":"variant-analysis/dunovo","topic_id":"variant-analysis","tutorial_id":"dunovo","creators":[],"name":"Du Novo GTN Tutorial - Variant Calling","title":"Du Novo GTN Tutorial - Variant Calling","version":3,"description":"Run this on the trimmed consensus reads (DCS or SSCS) from Du Novo.\n","tags":["variant-analysis"],"features":{"report":null,"subworkflows":false,"comments":false,"parameters":false},"workflowhub_id":"1089","history":[{"hash":"eb4d724e0064c77beb20efa626a0f28fd0500676","unix":"1579084895","message":"Workflow renaming","short_hash":"eb4d724e0","num":3},{"hash":"361236c416497d2d9f2735d64f8c43050a5a5a4e","unix":"1554368414","message":"Changed format of workflows","short_hash":"361236c41","num":2},{"hash":"76979680776eafe50610d00238ad8b00da835c7c","unix":"1532662117","message":"Update rare variant calling tutorial for GTN consistency and new tool version. - Format to be more consistent with other GTN tutorials. - Update to work with newer version of Du Novo (2.15 instead of 0.3). - Restructure logic and flow, add more explanations. - Add workflow files.","short_hash":"769796807","num":1}],"test_results":null,"modified":"2024-07-15 09:26:23 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nTrimmed reads mate 1\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nTrimmed reads mate 2\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"Map with BWA-MEM\"];\n  0 -->|output| 2;\n  1 -->|output| 2;\n  3[\"BamLeftAlign\"];\n  2 -->|bam_output| 3;\n  4[\"Naive Variant Caller NVC\"];\n  3 -->|output_bam| 4;\n  5[\"Variant Annotator\"];\n  4 -->|output_vcf| 5;\n  6[\"Filter\"];\n  5 -->|output| 6;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightblue,label=\"ℹ️ Input Dataset\\nTrimmed reads mate 1\"]\n  1[color=lightblue,label=\"ℹ️ Input Dataset\\nTrimmed reads mate 2\"]\n  2[label=\"Map with BWA-MEM\"]\n  0 -> 2 [label=\"output\"]\n  1 -> 2 [label=\"output\"]\n  3[label=\"BamLeftAlign\"]\n  2 -> 3 [label=\"bam_output\"]\n  4[label=\"Naive Variant Caller NVC\"]\n  3 -> 4 [label=\"output_bam\"]\n  5[label=\"Variant Annotator\"]\n  4 -> 5 [label=\"output_vcf\"]\n  6[label=\"Filter\"]\n  5 -> 6 [label=\"output\"]\n}","workflow_tools":["toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.1","toolshed.g2.bx.psu.edu/repos/devteam/freebayes/bamleftalign/1.1.0.46-0","toolshed.g2.bx.psu.edu/repos/blankenberg/naive_variant_caller/naive_variant_caller/0.0.4","toolshed.g2.bx.psu.edu/repos/nick/allele_counts/allele_counts_1/1.2","Filter1"]}],"api":"https://training.galaxyproject.org/training-material/api/topics/variant-analysis/tutorials/dunovo/tutorial.json","tools":["Filter1","toolshed.g2.bx.psu.edu/repos/blankenberg/naive_variant_caller/naive_variant_caller/0.0.4","toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.1","toolshed.g2.bx.psu.edu/repos/devteam/freebayes/bamleftalign/1.1.0.46-0","toolshed.g2.bx.psu.edu/repos/nick/allele_counts/allele_counts_1/1.2","toolshed.g2.bx.psu.edu/repos/nick/dunovo/align_families/2.15","toolshed.g2.bx.psu.edu/repos/nick/dunovo/correct_barcodes/2.15","toolshed.g2.bx.psu.edu/repos/nick/dunovo/dunovo/2.15","toolshed.g2.bx.psu.edu/repos/nick/dunovo/make_families/2.15","toolshed.g2.bx.psu.edu/repos/nick/sequence_content_trimmer/sequence_content_trimmer/0.1"],"supported_servers":{"exact":[{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}],"inexact":[]},"topic_name_human":"Variant Analysis","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"naive_variant_caller","owner":"blankenberg","revisions":"6be51647d31a","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bwa","owner":"devteam","revisions":"3fe632431b68","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"freebayes","owner":"devteam","revisions":"156b60c1530f","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"allele_counts","owner":"nick","revisions":"411adeff1eec","tool_panel_section_label":"Variant Calling","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dunovo","owner":"nick","revisions":"9dc43bf7d1db","tool_panel_section_label":"Du Novo","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dunovo","owner":"nick","revisions":"9dc43bf7d1db","tool_panel_section_label":"Du Novo","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dunovo","owner":"nick","revisions":"9dc43bf7d1db","tool_panel_section_label":"Du Novo","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"dunovo","owner":"nick","revisions":"9dc43bf7d1db","tool_panel_section_label":"Du Novo","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"sequence_content_trimmer","owner":"nick","revisions":"7f170cb06e2e","tool_panel_section_label":"Du Novo","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: naive_variant_caller\n  owner: blankenberg\n  revisions: 6be51647d31a\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bwa\n  owner: devteam\n  revisions: 3fe632431b68\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: freebayes\n  owner: devteam\n  revisions: 156b60c1530f\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: allele_counts\n  owner: nick\n  revisions: 411adeff1eec\n  tool_panel_section_label: Variant Calling\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dunovo\n  owner: nick\n  revisions: 9dc43bf7d1db\n  tool_panel_section_label: Du Novo\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dunovo\n  owner: nick\n  revisions: 9dc43bf7d1db\n  tool_panel_section_label: Du Novo\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dunovo\n  owner: nick\n  revisions: 9dc43bf7d1db\n  tool_panel_section_label: Du Novo\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: dunovo\n  owner: nick\n  revisions: 9dc43bf7d1db\n  tool_panel_section_label: Du Novo\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: sequence_content_trimmer\n  owner: nick\n  revisions: 7f170cb06e2e\n  tool_panel_section_label: Du Novo\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","tags":["work-in-progress"]}